<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="userMapper">
    <insert id="createUser">
        <choose>
            <when test="password != null">
                INSERT INTO user (email, password, nickname, activated <if test="img_url != null">, img_url</if>)
                VALUES (#{email}, #{password}, #{nickname}, 1 <if test="img_url != null">, #{img_url}</if>)
            </when>
            <otherwise>
                INSERT INTO user (email, nickname, activated <if test="img_url != null">, img_url</if>)
                VALUES (#{email}, #{nickname}, 1 <if test="img_url != null">, #{img_url}</if>)
            </otherwise>
        </choose>
    </insert>

    <select id="isEmailExists" resultType="boolean">
        SELECT EXISTS (SELECT 1 FROM user WHERE email = #{email})
    </select>

    <select id="userExistsSNSId" resultType="boolean" parameterType="int">
        SELECT user_id FROM user WHERE sns_id = #{sns_id}
    </select>

    <select id="userExists">
        SELECT user_id, password FROM user WHERE email = #{email}
    </select>

    <select id="userInfo" parameterType="int">
        SELECT user_id AS userId, nickname, img_url, img_name FROM user WHERE user_id = #{user_id}
    </select>
</mapper>